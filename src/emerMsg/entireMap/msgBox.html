<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
	<title>메시지박스</title>
	<link rel="stylesheet" th:href="@{/css/style.css}" />
	<script th:src="@{/js/jquery-3.7.1.min.js}"></script>
	<script th:src="@{/js/axios.min.js}"></script>
	<style>
		table {
			width: 100%;
		}
		#msgBox {
			margin-top: 20px;
			padding: 10px;
			border: 1px solid #ccc;
			background-color: #f9f9f9;
		}
	</style>
</head>
<body>
	
	<header th:replace="~{fragments/header :: header}"></header>
	
	<main>
	<div id="msgBox">
	<p id="det"></p>
		<table>
			<thead>
				<tr>
					<th>일련번호</th>
					<th>메시지 내용</th>
					<th>수신 지역</th>
					<th>생성 일자</th>
					<th>등록 일자</th>
					<th>긴급 단계명</th>
					<th>재해 구분명</th>
					<th>수정 일자</th>
				</tr>
			</thead>
			<tbody id="tbody">
			</tbody>
			
		</table>
		</div>

		
			
		
	</main>
	
	<footer th:replace="~{fragments/footer :: footer}"></footer>
	
	<script>
		
	axios.get('http://localhost:8111/api/safety/message') // 수정필요
				.then((response)  => {
				const { data } = response;
				let html = '';
				
				data.forEach(item => {
					console.log(item);
					html += `
					<tr>
						<td>${item.sn}</td>
						<td>${item.msgCn}</td>
						<td>${item.rcptnRgnNm}</td>
						<td>${item.crdDt}</td> // new Date(item.crdDt).toLocaleString()
						<td>${item.regYmd}</td>
						<td>${item.emerStepNm}</td>
						<td>${item.detSeNm}</td>
						<td>${item.mdfcnYmd}</td> //new Date(message.mdfcnYmd).toLocaleString()
					</tr>
					`;
										
				});
				document.querySelector('#tbody').innerHTML = html;
		})
			.catch((error) => {
				console.log("문자를 가져오는 중 오류 발생", error);
				return null;
			})
			.finally(() =>{
				console.log('done');
				});
	// 메세지가 없을 때의 코드 추가
				</script>


</body>
</html>
